{
	"id": "ca.parallel_launcher.ParallelLauncher",
	"runtime": "org.kde.Platform",
	"runtime-version": "5.15-22.08",
	"sdk": "org.kde.Sdk",
	"command": "parallel-launcher",
	"finish-args" : [
		"--socket=x11",
		"--socket=wayland",
		"--socket=pulseaudio",
		"--share=ipc",
		"--share=network",
		"--device=all",
		"--filesystem=host",
		"--talk-name=org.freedesktop.ScreenSaver",
		"--talk-name=org.freedesktop.PowerManagement.Inhibit",
		"--talk-name=org.freedesktop.login1",
		"--filesystem=xdg-run/app/com.discordapp.Discord:create"
	],
	"modules": [
		{
			"name": "rapidjson",
			"buildsystem": "cmake-ninja",
			"config-opts": [
				"-DRAPIDJSON_BUILD_DOC=OFF",
				"-DRAPIDJSON_BUILD_EXAMPLES=OFF",
				"-DRAPIDJSON_BUILD_TESTS=OFF",
				"-DRAPIDJSON_BUILD_THIRDPARTY_GTEST=OFF"
			],
			"cleanup": [
				"/include",
				"/lib/cmake",
				"/lib/pkgconfig",
				"/share/doc"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/Tencent/rapidjson.git",
					"commit": "f54b0e47a08782a6131cc3d60f94d038fa6e0a51"
				}
			]
		},
		{
			"name": "discord-rpc",
			"buildsystem": "cmake-ninja",
			"config-opts": [
				"-DBUILD_SHARED_LIBS=ON",
				"-DBUILD_EXAMPLES=OFF"
			],
			"cleanup": [ "/include" ],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/discord/discord-rpc.git",
					"commit": "c59fd6df20c6904ab39f026e87af1dd90fcac7ff"
				}
			]
		},
		{
			"name": "retroarch",
			"config-opts": [ "--enable-dbus" ],
			"make-args": [ "GLOBAL_CONFIG_DIR=/app/etc" ],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/libretro/RetroArch.git",
					"commit": "ad89b0c655fc1d25adfcdf40268e95c5d0391111"
				},
				{
					"type": "file",
					"path": "retroarch.cfg"
				}
			],
			"post-install": [
				"install -D -t /app/etc/ retroarch.cfg"
			]
		},
		{
			"name": "retroarch-assets",
			"make-install-args": [ "PREFIX=/app" ],
			"sources": [{
				"type": "git",
				"url": "https://github.com/libretro/retroarch-assets.git",
				"commit": "4ec80faf1b5439d1654f407805bb66141b880826"
			}]
		},
		{
			"name": "libretro-database",
			"make-install-args": [ "PREFIX=/app" ],
			"sources": [{
				"type": "git",
				"url": "https://github.com/libretro/libretro-database.git",
				"commit": "183babc61f6a7aa6077e663bb2a8bb91d11d6874"
			}]
		},
		{
			"name": "parallel-launcher",
			"buildsystem": "qmake",
			"config-opts": [
				"CONFIG+=flatpak-version",
				"CONFIG+=no-precompiled-helpers",
				"LIBS+=-L/app/lib"
			],
			"sources": [{
				"type": "git",
				"url": "https://gitlab.com/parallel-launcher/parallel-launcher.git",
				"commit": "ddd48d4eab6521fc490961e4d8ab53234fae55af"
			}],
			"post-install": [
				"install -D -t /app/share/parallel-launcher/translations/ lang/*.qm",
				"mkdir -p /app/share/icons/hicolor/128x128/apps",
				"mkdir -p /app/share/mime/packages",
				"mv -f data/appicon.svg /app/share/icons/hicolor/128x128/apps/ca.parallel_launcher.ParallelLauncher.svg",
				"mv -f bps-mime.xml /app/share/mime/packages/ca.parallel_launcher.ParallelLauncher.xml",
				"sed -i '/<image[^>]*xml:lang/d' ca.parallel_launcher.ParallelLauncher.metainfo.xml",
				"install -D -t /app/share/metainfo/ ca.parallel_launcher.ParallelLauncher.metainfo.xml"
			]
		}
	]
}
